/**
 * skylark-textmask - A version of textmask that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-textmask/
 * @license MIT
 */
define(["./adjustCaretPosition","./conformToMask","./utilities","./constants","./constants"],function(e,r,o,t,n){"use strict";const i="",a="none",s="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),u="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:setTimeout;return function(l){const d={previousConformedValue:void 0,previousPlaceholder:void 0};return{state:d,update(c,{inputElement:p,mask:v,guide:f,pipe:h,placeholderChar:m=t,keepCharPositions:C=!1,showMask:P=!1}=l){if(void 0===c&&(c=p.value),c===d.previousConformedValue)return;let g,k;if("object"==typeof v&&void 0!==v.pipe&&void 0!==v.mask&&(h=v.pipe,v=v.mask),v instanceof Array&&(g=o.convertMaskToPlaceholder(v,m)),!1===v)return;const V=function(e){if(o.isString(e))return e;if(o.isNumber(e))return String(e);if(void 0===e||null===e)return i;throw new Error("The 'value' provided to Text Mask needs to be a string or a number. The value "+`received was:\n\n ${JSON.stringify(e)}`)}(c),{selectionEnd:T}=p,{previousConformedValue:y,previousPlaceholder:w}=d;let S;if(typeof v===n.strFunction){if(!1===(k=v(V,{currentCaretPosition:T,previousConformedValue:y,placeholderChar:m})))return;const{maskWithoutCaretTraps:e,indexes:r}=o.processCaretTraps(k);k=e,S=r,g=o.convertMaskToPlaceholder(k,m)}else k=v;const b={previousConformedValue:y,guide:f,placeholderChar:m,pipe:h,placeholder:g,currentCaretPosition:T,keepCharPositions:C},{conformedValue:x}=r(V,k,b),A=typeof h===n.strFunction;let M={};A&&(!1===(M=h(x,Object.assign({rawValue:V},b)))?M={value:y,rejected:!0}:o.isString(M)&&(M={value:M}));const j=A?M.value:x,E=e({previousConformedValue:y,previousPlaceholder:w,conformedValue:j,placeholder:g,rawValue:V,currentCaretPosition:T,placeholderChar:m,indexesOfPipedChars:M.indexesOfPipedChars,caretTrapIndexes:S}),F=j===g&&0===E?P?g:i:j;var O,q;(d.previousConformedValue=F,d.previousPlaceholder=g,p.value!==F)&&(p.value=F,O=p,q=E,document.activeElement===O&&(s?u(()=>O.setSelectionRange(q,q,a),0):O.setSelectionRange(q,q,a)))}}}});
//# sourceMappingURL=sourcemaps/createTextMaskInputElement.js.map
