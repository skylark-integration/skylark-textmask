/**
 * skylark-textmask - A version of textmask that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-textmask/
 * @license MIT
 */
!function(e,t){var r=t.define,require=t.require,n="function"==typeof r&&r.amd,o=!n&&"undefined"!=typeof exports;if(!n&&!r){var s={};r=t.define=function(e,t,r){"function"==typeof r?(s[e]={factory:r,deps:t.map(function(t){return function(e,t){if("."!==e[0])return e;var r=t.split("/"),n=e.split("/");r.pop();for(var o=0;o<n.length;o++)"."!=n[o]&&(".."==n[o]?r.pop():r.push(n[o]));return r.join("/")}(t,e)}),resolved:!1,exports:null},require(e)):s[e]={factory:null,resolved:!0,exports:r}},require=t.require=function(e){if(!s.hasOwnProperty(e))throw new Error("Module "+e+" has not been defined");var module=s[e];if(!module.resolved){var r=[];module.deps.forEach(function(e){r.push(require(e))}),module.exports=module.factory.apply(t,r)||null,module.resolved=!0}return module.exports}}if(!r)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(e,require){e("skylark-textmask/constants",[],function(){"use strict";return{placeholderChar:"_",strFunction:"function"}}),e("skylark-textmask/utilities",["./constants"],function(e){"use strict";const t=[];function r(e){return Array.isArray&&Array.isArray(e)||e instanceof Array}const n="[]";return{convertMaskToPlaceholder:function(n=t,o=e){if(!r(n))throw new Error("Text-mask:convertMaskToPlaceholder; The mask property must be an array.");if(-1!==n.indexOf(o))throw new Error("Placeholder character must not be used as part of the mask. Please specify a character that is not present in your mask as your placeholder character.\n\n"+`The placeholder character that was received is: ${JSON.stringify(o)}\n\n`+`The mask that was received is: ${JSON.stringify(n)}`);return n.map(e=>e instanceof RegExp?o:e).join("")},isArray:r,isString:function(e){return"string"==typeof e||e instanceof String},isNumber:function(e){return"number"==typeof e&&void 0===e.length&&!isNaN(e)},isNil:function(e){return void 0===e||null===e},processCaretTraps:function(e){const t=[];let r;for(;-1!==(r=e.indexOf(n));)t.push(r),e.splice(r,1);return{maskWithoutCaretTraps:e,indexes:t}}}}),e("skylark-textmask/conformToMask",["./utilities","./constants","./constants"],function(e,t,r){"use strict";const n=[],o="";return function(s=o,i=n,a={}){if(!e.isArray(i)){if(typeof i!==r.strFunction)throw new Error("Text-mask:conformToMask; The mask property must be an array.");i=i(s,a),i=e.processCaretTraps(i).maskWithoutCaretTraps}const{guide:l=!0,previousConformedValue:u=o,placeholderChar:c=t,placeholder:f=e.convertMaskToPlaceholder(i,c),currentCaretPosition:d,keepCharPositions:p}=a,h=!1===l&&void 0!==u,k=s.length,m=u.length,v=f.length,g=i.length,y=k-m,x=y>0,C=d+(x?-y:0),T=C+Math.abs(y);if(!0===p&&!x){let e=o;for(let t=C;t<T;t++)f[t]===c&&(e+=c);s=s.slice(0,C)+e+s.slice(C,k)}const P=s.split(o).map((e,t)=>({char:e,isNew:t>=C&&t<T}));for(let e=k-1;e>=0;e--){const{char:t}=P[e];if(t!==c){const r=e>=C&&m===g;t===f[r?e-y:e]&&P.splice(e,1)}}let w=o,b=!1;e:for(let e=0;e<v;e++){const t=f[e];if(t===c){if(P.length>0)for(;P.length>0;){const{char:t,isNew:r}=P.shift();if(t===c&&!0!==h){w+=c;continue e}if(i[e].test(t)){if(!0===p&&!1!==r&&u!==o&&!1!==l&&x){const r=P.length;let n=null;for(let e=0;e<r;e++){const t=P[e];if(t.char!==c&&!1===t.isNew)break;if(t.char===c){n=e;break}}null!==n?(w+=t,P.splice(n,1)):e--}else w+=t;continue e}b=!0}!1===h&&(w+=f.substr(e,v));break}w+=t}if(h&&!1===x){let e=null;for(let t=0;t<w.length;t++)f[t]===c&&(e=t);w=null!==e?w.substr(0,e+1):o}return{conformedValue:w,meta:{someCharsRejected:b}}}}),e("skylark-textmask/adjustCaretPosition",[],function(){"use strict";const e=[];return function({previousConformedValue:t="",previousPlaceholder:r="",currentCaretPosition:n=0,conformedValue:o,rawValue:s,placeholderChar:i,placeholder:a,indexesOfPipedChars:l=e,caretTrapIndexes:u=e}){if(0===n||!s.length)return 0;const c=s.length,f=t.length,d=a.length,p=o.length,h=c-f,k=h>0,m=0===f,v=h>1&&!k&&!m;if(v)return n;const g=k&&(t===o||o===a);let y,x,C=0;if(g)C=n-h;else{const e=o.toLowerCase(),t=s.toLowerCase(),u=t.substr(0,n).split(""),c=u.filter(t=>-1!==e.indexOf(t));x=c[c.length-1];const f=r.substr(0,c.length).split("").filter(e=>e!==i).length,d=a.substr(0,c.length).split("").filter(e=>e!==i).length,h=d!==f,m=void 0!==r[c.length-1]&&void 0!==a[c.length-2]&&r[c.length-1]!==i&&r[c.length-1]!==a[c.length-1]&&r[c.length-1]===a[c.length-2];!k&&(h||m)&&f>0&&a.indexOf(x)>-1&&void 0!==s[n]&&(y=!0,x=s[n]);const v=l.map(t=>e[t]),g=v.filter(e=>e===x).length,T=c.filter(e=>e===x).length,P=a.substr(0,a.indexOf(i)).split("").filter((e,t)=>e===x&&s[t]!==e).length,w=P+T+g+(y?1:0);let b=0;for(let t=0;t<p;t++){const r=e[t];if(C=t+1,r===x&&b++,b>=w)break}}if(k){let e=C;for(let t=C;t<=d;t++)if(a[t]===i&&(e=t),a[t]===i||-1!==u.indexOf(t)||t===d)return e}else if(y){for(let e=C-1;e>=0;e--)if(o[e]===x||-1!==u.indexOf(e)||0===e)return e}else for(let e=C;e>=0;e--)if(a[e-1]===i||-1!==u.indexOf(e)||0===e)return e}}),e("skylark-textmask/createTextMaskInputElement",["./adjustCaretPosition","./conformToMask","./utilities","./constants","./constants"],function(e,t,r,n,o){"use strict";const s="",i="none",a="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),l="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:setTimeout;return function(u){const c={previousConformedValue:void 0,previousPlaceholder:void 0};return{state:c,update(f,{inputElement:d,mask:p,guide:h,pipe:k,placeholderChar:m=n,keepCharPositions:v=!1,showMask:g=!1}=u){if(void 0===f&&(f=d.value),f===c.previousConformedValue)return;let y,x;if("object"==typeof p&&void 0!==p.pipe&&void 0!==p.mask&&(k=p.pipe,p=p.mask),p instanceof Array&&(y=r.convertMaskToPlaceholder(p,m)),!1===p)return;const C=function(e){if(r.isString(e))return e;if(r.isNumber(e))return String(e);if(void 0===e||null===e)return s;throw new Error("The 'value' provided to Text Mask needs to be a string or a number. The value "+`received was:\n\n ${JSON.stringify(e)}`)}(f),{selectionEnd:T}=d,{previousConformedValue:P,previousPlaceholder:w}=c;let b;if(typeof p===o.strFunction){if(!1===(x=p(C,{currentCaretPosition:T,previousConformedValue:P,placeholderChar:m})))return;const{maskWithoutCaretTraps:e,indexes:t}=r.processCaretTraps(x);x=e,b=t,y=r.convertMaskToPlaceholder(x,m)}else x=p;const M={previousConformedValue:P,guide:h,placeholderChar:m,pipe:k,placeholder:y,currentCaretPosition:T,keepCharPositions:v},{conformedValue:O}=t(C,x,M),V=typeof k===o.strFunction;let E={};V&&(!1===(E=k(O,Object.assign({rawValue:C},M)))?E={value:P,rejected:!0}:r.isString(E)&&(E={value:E}));const j=V?E.value:O,A=e({previousConformedValue:P,previousPlaceholder:w,conformedValue:j,placeholder:y,rawValue:C,currentCaretPosition:T,placeholderChar:m,indexesOfPipedChars:E.indexesOfPipedChars,caretTrapIndexes:b}),N=j===y&&0===A,S=g?y:s,F=N?S:j;var q,I;(c.previousConformedValue=F,c.previousPlaceholder=y,d.value!==F)&&(d.value=F,q=d,I=A,document.activeElement===q&&(a?l(()=>q.setSelectionRange(I,I,i),0):q.setSelectionRange(I,I,i)))}}}}),e("skylark-textmask/main",["skylark-langx/skylark","./conformToMask","./adjustCaretPosition","./createTextMaskInputElement"],function(e,t,r,n){"use strict";return e.attach("intg.textmask",{conformToMask:t,adjustCaretPosition:r,createTextMaskInputElement:n})}),e("skylark-textmask",["skylark-textmask/main"],function(e){return e})}(r),!n){var i=require("skylark-langx/skylark");o?module.exports=i:t.skylarkjs=i}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-textmask.js.map
